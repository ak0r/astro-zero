---
import { render } from 'astro:content';
import type { Page } from "@/types";
import { generatePageSEO } from '@/utils/seo';
import BaseLayout from '@/layouts/BaseLayout.astro';
import SEO from '@/components/common/SEO.astro';
import Container from '@/components/layout/Container.astro';
import PageHeader from '@/components/layout/PageHeader.astro';

export interface Props {
  page: Page;
}

const { page } = Astro.props;

// Auto-generate breadcrumb from current path
const currentPath = Astro.url.pathname;

// Process the page content
const { Content, headings } = await render(page);
const pageTitle = page.data.title;
const pageDesc = page.data.description;

// Generate SEO data
const seoData = generatePageSEO(page, Astro.url.href);

---

<BaseLayout>
  <!-- SEO -->
  <SEO data={seoData} slot="seo" />

  <Container class="py-8">
    <PageHeader
      breadcrumb={currentPath}
      title={pageTitle}
      description={pageDesc}
    />

    <article data-pagefind-body class="animate md-content flex flex-col gap-y-10">
      <meta data-pagefind-meta="collection[content]" content="pages" />
      <meta data-pagefind-meta="title[content]" content={pageTitle} />

      <!-- Article content -->
      <div class="" id="page-content">
        <Content />
        <slot />
      </div>
    </article>
  </Container>
</BaseLayout>