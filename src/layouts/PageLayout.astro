---
/**
 * PageLayout Component
 *
 * Layout for static pages.
 * Uses ContentLayout for shared structure.
 */
import { render } from 'astro:content';
import type { Page } from "@/types";
import { generatePageSEO } from '@/utils/seo';
import ContentLayout from './ContentLayout.astro';
import PageHeader from '@/components/layout/PageHeader.astro';

export interface Props {
  page: Page;
}

const { page } = Astro.props;

// Auto-generate breadcrumb from current path
const currentPath = Astro.url.pathname;

// Process the page content
const { Content } = await render(page);
const pageTitle = page.data.title;
const pageDesc = page.data.description;

// Generate SEO data
const seoData = generatePageSEO(page, Astro.url.href);
---

<ContentLayout seo={seoData}>
  {/* Header Slot */}
  <Fragment slot="header">
    <PageHeader
      breadcrumb={currentPath}
      title={pageTitle}
      description={pageDesc ?? undefined}
    />
  </Fragment>

  {/* Content Slot */}
  <Fragment slot="content">
    <meta data-pagefind-meta="collection[content]" content="pages" />
    <meta data-pagefind-meta="title[content]" content={pageTitle} />

    <div class="" id="page-content">
      <Content />
      <slot />
    </div>
  </Fragment>
</ContentLayout>
