---
import type { BreadcrumbItem } from "@/types";
import Icon from '@/components/common/IconWrapper.astro';

interface Props {
  items: BreadcrumbItem[];
  separator?: 'chevron' | 'slash' | 'arrow';
  showHome?: boolean;
  class?: string;
}

const {
  items,
  separator = 'chevron',
  showHome = true,
  class: customClass = '',
} = Astro.props;

// Separator icons/text
const separators = {
  chevron: 'chevron-right',
  slash: 'slash',
  arrow: 'arrow-right',
};

const separatorIcon = separators[separator];

// Build breadcrumb trail
const breadcrumbs: BreadcrumbItem[] = [];

// Add home if enabled
if (showHome) {
  breadcrumbs.push({ label: 'Home', href: '/' });
}

// Add provided items
breadcrumbs.push(...items);
---

<section 
  aria-label="Breadcrumb" 
  class={`breadcrumb not-prose flex items-center gap-2 text-sm ${customClass}`}
>
  <ol class="flex items-center gap-2 flex-wrap">
    {breadcrumbs.map((item, index) => {
      const isLast = index === breadcrumbs.length - 1;
      const isHome = index === 0 && showHome;

      return (
        <li class="flex items-center gap-2">
          {/* Breadcrumb item */}
          {item.href && !isLast ? (
            <a
              href={item.href}
              class="text-content-3 hover:text-content transition-colors"
              aria-label={isHome ? 'Go to homepage' : `Go to ${item.label}`}
            >
              {isHome ? (
                <Icon name="home" class="size-4" />
              ) : (
                <span>{item.label}</span>
              )}
            </a>
          ) : (
            <span 
              class={isLast ? 'text-content font-medium' : 'text-content-3'}
              aria-current={isLast ? 'page' : undefined}
            >
              {isHome ? (
                <Icon name="home" class="size-4" />
              ) : (
                item.label
              )}
            </span>
          )}

          {/* Separator (not for last item) */}
          {!isLast && (
            <span
              class="separator text-content-3"
              aria-hidden="true"
            >
              <Icon name={separatorIcon} class="size-4" />
            </span>
          )}
        </li>
      );
    })}
  </ol>
</section>