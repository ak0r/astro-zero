---
import type { Post } from '@/types';
import LinkWrapper from '@/components/common/LinkWrapper.astro';
import IconWrapper from '@/components/common/IconWrapper.astro';

interface Props {
  prevEntry?: Post;
  nextEntry?: Post;
  parentEntry?: Post;
}

const { prevEntry, nextEntry, parentEntry } = Astro.props;

const isSubpost = !!parentEntry;
const gridClass = isSubpost ? 'sm:grid-cols-3' : 'sm:grid-cols-2';

// Helper function to get the base path from collection
const getBasePath = (entry: Post): string => {
  return entry.collection === 'posts' ? '/posts' : '/galleries';
};
---
<section class="mt-12 pt-8 border-t border-ui">
  <nav class={`grid grid-cols-1 gap-4 ${gridClass}`}>
    <!-- Previous Entry -->
    {prevEntry ? (
      <LinkWrapper
        href={`${getBasePath(prevEntry)}/${prevEntry.id}`}
        class="internal-link post-nav group flex justify-start items-center gap-4 p-2 rounded-lg border border-ui transition-all"
        aria-disabled={!prevEntry}
      >
        <IconWrapper
          name="arrow-left"
          class="shrink-0 size-5 text-content-3 transition-transform group-hover:-translate-x-1"
        />
        <div class="flex flex-col items-start overflow-hidden text-left text-wrap">
          <div class="text-xs mb-1 text-content-3">
            {isSubpost ? 'Previous Subpost' : 'Previous Post'}
          </div>
          <div class="w-full text-left text-sm text-content-2 text-balance text-ellipsis">
            {
              prevEntry.data.title || 
              (isSubpost ? 'No older subposts' : "You're at the oldest post!")
            }
          </div>
        </div>
      </LinkWrapper>
    ) : (
      <div class="h-full"></div>
    )}
    
    <!-- Parent Entry -->
    {isSubpost && (
      <LinkWrapper
        href={`${getBasePath(parentEntry)}/${parentEntry.id}`}
        class="internal-link post-nav group flex size-full items-center justify-center gap-4 p-2 rounded-lg border border-ui transition-all"
        aria-disabled={!parentEntry}
      >
        <IconWrapper
          name="corner-left-up"
          class="shrink-0 size-5 text-content-3 transition-transform group-hover:-translate-y-1"
        />
        <div class="flex flex-col items-center overflow-hidden text-center text-wrap">
          <div class="text-xs mb-1 text-content-3">
            Parent Post
          </div>
          <div class="w-full text-left text-sm text-content-2 text-ellipsis">
            {
              parentEntry.data.title || 'No parent post'
            }
          </div>
        </div>
      </LinkWrapper>
    )}

    <!-- Next Entry -->
    {nextEntry ? (
      
      <LinkWrapper
        href={`${getBasePath(nextEntry)}/${nextEntry.id}`}
        class="internal-link post-nav group flex justify-end items-center gap-4 p-2 rounded-lg border border-ui transition-all"
        aria-disabled={!nextEntry}
      >
        <div class="flex flex-col items-end overflow-hidden text-right text-wrap">
          <div class="text-xs mb-1 text-content-3">
            {isSubpost ? 'Next Subpost' : 'Next Post'}
          </div>
          <div class="w-full text-right text-sm text-content-2 text-balance text-ellipsis">
            {
              nextEntry.data.title || 
              (isSubpost ? 'No newer subposts' : "You're at the newest post!")
            }
          </div>
        </div>
        <IconWrapper
          name="arrow-right"
          class="shrink-0 size-5 text-content-3 transition-transform group-hover:translate-x-1"
        />
      </LinkWrapper>
    ) : (
      <div class="h-full"></div>
    )}
  </nav>
</section>